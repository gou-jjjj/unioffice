//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package utils

import (
	_d "bytes"

	_b "github.com/gou-jjjj/unioffice/document"
	_g "github.com/gou-jjjj/unioffice/document/convert"
	_f "github.com/unidoc/unipdf/v4/model"
)

// GetNumPages will try to get actual document page count by converting the document to a PDF first
// and then get the actual page count from the PDF result.
//
// WARNING: This method is currently in experimental state as the PDF result might have incorrect page count.
func GetNumPages(d *_b.Document) (int, error) {
	var _eg _d.Buffer
	_a := _g.ConvertToPdf(d)
	if _dd := _a.Write(&_eg); _dd != nil {
		return 0, _dd
	}
	_gc, _ec := _f.NewPdfReader(_d.NewReader(_eg.Bytes()))
	if _ec != nil {
		return 0, _ec
	}
	_c, _ec := _gc.GetNumPages()
	if _ec != nil {
		return 0, _ec
	}
	return _c, nil
}
